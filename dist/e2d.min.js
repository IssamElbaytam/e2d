!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.e2d=e()}}(function(){return function e(t,r,n){function s(o,a){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(i)return i(o,!0);var c=Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[o]={exports:{}};t[o][0].call(u.exports,function(e){var r=t[o][1][e];return s(r?r:e)},u,u.exports,e,t,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e,t,r){(function(e){function t(e,t){for(var r=0,n=e.length-1;n>=0;n--){var s=e[n];"."===s?e.splice(n,1):".."===s?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return s.exec(e).slice(1)};r.resolve=function(){for(var r="",s=!1,i=arguments.length-1;i>=-1&&!s;i--){var o=0>i?e.cwd():arguments[i];if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(r=o+"/"+r,s="/"===o.charAt(0))}return r=t(n(r.split("/"),function(e){return!!e}),!s).join("/"),(s?"/":"")+r||"."},r.normalize=function(e){var s=r.isAbsolute(e),i="/"===o(e,-1);return e=t(n(e.split("/"),function(e){return!!e}),!s).join("/"),e||s||(e="."),e&&i&&(e+="/"),(s?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,function(e){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},r.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var s=n(e.split("/")),i=n(t.split("/")),o=Math.min(s.length,i.length),a=o,l=0;o>l;l++)if(s[l]!==i[l]){a=l;break}for(var c=[],l=a;l<s.length;l++)c.push("..");return c=c.concat(i.slice(a)),c.join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){var t=i(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},r.basename=function(e,t){var r=i(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},r.extname=function(e){return i(e)[3]};var o="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return 0>t&&(t=e.length+t),e.substr(t,r)}}).call(this,e("_process"))},{_process:2}],2:[function(e,t){function r(){c=!1,o.length?l=o.concat(l):u=-1,l.length&&n()}function n(){if(!c){var e=setTimeout(r);c=!0;for(var t=l.length;t;){for(o=l,l=[];++u<t;)o[u].run();u=-1,t=l.length}o=null,c=!1,clearTimeout(e)}}function s(e,t){this.fun=e,this.array=t}function i(){}var o,a=t.exports={},l=[],c=!1,u=-1;a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new s(e,t)),1!==l.length||c||setTimeout(n,0)},s.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=i,a.addListener=i,a.once=i,a.off=i,a.removeListener=i,a.removeAllListeners=i,a.emit=i,a.binding=function(){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(){throw Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],3:[function(e,t){"use strict";t.exports={Canvas:e("./src\\Canvas.js"),Img:e("./src\\Img.js"),Instruction:e("./src\\Instruction.js"),Renderer:e("./src\\Renderer.js"),arc:e("./src\\arc.js"),arcTo:e("./src\\arcTo.js"),beginPath:e("./src\\beginPath.js"),bezierCurveTo:e("./src\\bezierCurveTo.js"),clearRect:e("./src\\clearRect.js"),clip:e("./src\\clip.js"),clipPath:e("./src\\clipPath.js"),closePath:e("./src\\closePath.js"),drawCanvas:e("./src\\drawCanvas.js"),drawImage:e("./src\\drawImage.js"),ellipse:e("./src\\ellipse.js"),fill:e("./src\\fill.js"),fillArc:e("./src\\fillArc.js"),fillRect:e("./src\\fillRect.js"),fillStyle:e("./src\\fillStyle.js"),globalCompositeOperation:e("./src\\globalCompositeOperation.js"),isDataUrl:e("./src\\isDataUrl.js"),isWorker:e("./src\\isWorker.js"),lineStyle:e("./src\\lineStyle.js"),lineTo:e("./src\\lineTo.js"),moveTo:e("./src\\moveTo.js"),path:e("./src\\path.js"),quadraticCurveTo:e("./src\\quadraticCurveTo.js"),rotate:e("./src\\rotate.js"),scale:e("./src\\scale.js"),shadowStyle:e("./src\\shadowStyle.js"),stroke:e("./src\\stroke.js"),strokeArc:e("./src\\strokeArc.js"),strokeRect:e("./src\\strokeRect.js"),text:e("./src\\text.js"),textStyle:e("./src\\textStyle.js"),transform:e("./src\\transform.js"),translate:e("./src\\translate.js")}},{"./src\\Canvas.js":21,"./src\\Img.js":22,"./src\\Instruction.js":23,"./src\\Renderer.js":24,"./src\\arc.js":25,"./src\\arcTo.js":26,"./src\\beginPath.js":27,"./src\\bezierCurveTo.js":28,"./src\\clearRect.js":29,"./src\\clip.js":30,"./src\\clipPath.js":31,"./src\\closePath.js":32,"./src\\drawCanvas.js":33,"./src\\drawImage.js":34,"./src\\ellipse.js":35,"./src\\fill.js":36,"./src\\fillArc.js":37,"./src\\fillRect.js":38,"./src\\fillStyle.js":39,"./src\\globalCompositeOperation.js":40,"./src\\isDataUrl.js":41,"./src\\isWorker.js":42,"./src\\lineStyle.js":43,"./src\\lineTo.js":44,"./src\\moveTo.js":45,"./src\\path.js":46,"./src\\quadraticCurveTo.js":47,"./src\\rotate.js":48,"./src\\scale.js":49,"./src\\shadowStyle.js":50,"./src\\stroke.js":51,"./src\\strokeArc.js":52,"./src\\strokeRect.js":53,"./src\\text.js":54,"./src\\textStyle.js":55,"./src\\transform.js":56,"./src\\translate.js":57}],4:[function(e,t){function r(e,t,r){var i=e?e.length:0;return r&&s(e,t,r)&&(t=!1),i?n(e,t):[]}var n=e("../internal/baseFlatten"),s=e("../internal/isIterateeCall");t.exports=r},{"../internal/baseFlatten":6,"../internal/isIterateeCall":12}],5:[function(e,t){function r(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}t.exports=r},{}],6:[function(e,t){function r(e,t,l,c){c||(c=[]);for(var u=-1,h=e.length;++u<h;){var f=e[u];a(f)&&o(f)&&(l||i(f)||s(f))?t?r(f,t,l,c):n(c,f):l||(c[c.length]=f)}return c}var n=e("./arrayPush"),s=e("../lang/isArguments"),i=e("../lang/isArray"),o=e("./isArrayLike"),a=e("./isObjectLike");t.exports=r},{"../lang/isArguments":15,"../lang/isArray":16,"./arrayPush":5,"./isArrayLike":10,"./isObjectLike":14}],7:[function(e,t){function r(e){return function(t){return null==t?void 0:t[e]}}t.exports=r},{}],8:[function(e,t){var r=e("./baseProperty"),n=r("length");t.exports=n},{"./baseProperty":7}],9:[function(e,t){function r(e,t){var r=null==e?void 0:e[t];return n(r)?r:void 0}var n=e("../lang/isNative");t.exports=r},{"../lang/isNative":18}],10:[function(e,t){function r(e){return null!=e&&s(n(e))}var n=e("./getLength"),s=e("./isLength");t.exports=r},{"./getLength":8,"./isLength":13}],11:[function(e,t){function r(e,t){return e="number"==typeof e||n.test(e)?+e:-1,t=null==t?s:t,e>-1&&e%1==0&&t>e}var n=/^\d+$/,s=9007199254740991;t.exports=r},{}],12:[function(e,t){function r(e,t,r){if(!i(r))return!1;var o=typeof t;if("number"==o?n(r)&&s(t,r.length):"string"==o&&t in r){var a=r[t];return e===e?e===a:a!==a}return!1}var n=e("./isArrayLike"),s=e("./isIndex"),i=e("../lang/isObject");t.exports=r},{"../lang/isObject":19,"./isArrayLike":10,"./isIndex":11}],13:[function(e,t){function r(e){return"number"==typeof e&&e>-1&&e%1==0&&n>=e}var n=9007199254740991;t.exports=r},{}],14:[function(e,t){function r(e){return!!e&&"object"==typeof e}t.exports=r},{}],15:[function(e,t){function r(e){return s(e)&&n(e)&&o.call(e,"callee")&&!a.call(e,"callee")}var n=e("../internal/isArrayLike"),s=e("../internal/isObjectLike"),i=Object.prototype,o=i.hasOwnProperty,a=i.propertyIsEnumerable;t.exports=r},{"../internal/isArrayLike":10,"../internal/isObjectLike":14}],16:[function(e,t){var r=e("../internal/getNative"),n=e("../internal/isLength"),s=e("../internal/isObjectLike"),i="[object Array]",o=Object.prototype,a=o.toString,l=r(Array,"isArray"),c=l||function(e){return s(e)&&n(e.length)&&a.call(e)==i};t.exports=c},{"../internal/getNative":9,"../internal/isLength":13,"../internal/isObjectLike":14}],17:[function(e,t){function r(e){return n(e)&&o.call(e)==s}var n=e("./isObject"),s="[object Function]",i=Object.prototype,o=i.toString;t.exports=r},{"./isObject":19}],18:[function(e,t){function r(e){return null==e?!1:n(e)?c.test(a.call(e)):s(e)&&i.test(e)}var n=e("./isFunction"),s=e("../internal/isObjectLike"),i=/^\[object .+?Constructor\]$/,o=Object.prototype,a=Function.prototype.toString,l=o.hasOwnProperty,c=RegExp("^"+a.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=r},{"../internal/isObjectLike":14,"./isFunction":17}],19:[function(e,t){function r(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}t.exports=r},{}],20:[function(e,t){"use strict";var r=(t.exports=function(e,t,s){switch(s&&s.toLowerCase()){case"strassen":return n(e,t);case"naive":default:return r(e,t)}},function(e,t){for(var r=e.length,n=[],s=0;r>s;s++)n.push([]);for(var i=0;r>i;i++)for(var o=0;r>o;o++){n[i][o]=0;for(var a=0;r>a;a++)n[i][o]=n[i][o]+e[i][a]*t[a][o]}return n}),n=function s(e,t){for(var r=e.length,n=[],i=0;r>i;i++)n.push([]);if(1==r)n[0][0]=e[0][0]*t[0][0];else{var o=r/2,a=[],l=[],c=[],u=[],h=[],f=[],d=[],p=[];for(i=0;o>i;i++)a.push([]),l.push([]),c.push([]),u.push([]),h.push([]),f.push([]),d.push([]),p.push([]);var g,y;for(g=0;o>g;g++){for(y=0;o>y;y++)a[g][y]=e[g][y],h[g][y]=t[g][y];for(y=o;r>y;y++)l[g][y-o]=e[g][y],f[g][y-o]=t[g][y]}for(g=o;r>g;g++){for(y=0;o>y;y++)c[g-o][y]=e[g][y],d[g-o][y]=t[g][y];for(y=o;r>y;y++)u[g-o][y-o]=e[g][y],p[g-o][y-o]=t[g][y]}var w=[],v=[],x=[],m=[],b=[],j=[],k=[],I=[],A=[],O=[];for(i=0;o>i;i++)w.push([]),v.push([]),x.push([]),m.push([]),b.push([]),j.push([]),k.push([]),I.push([]),A.push([]),O.push([]);for(g=0;o>g;g++)for(y=0;o>y;y++)w[g][y]=f[g][y]-p[g][y],v[g][y]=a[g][y]+l[g][y],x[g][y]=c[g][y]+u[g][y],m[g][y]=d[g][y]-h[g][y],b[g][y]=a[g][y]+u[g][y],j[g][y]=h[g][y]+p[g][y],k[g][y]=l[g][y]-u[g][y],I[g][y]=d[g][y]+p[g][y],A[g][y]=a[g][y]-c[g][y],O[g][y]=h[g][y]+f[g][y];var C=s(a,w),S=s(v,p),P=s(x,h),T=s(u,m),L=s(b,j),W=s(k,I),D=s(A,O);for(g=0;o>g;g++)for(y=0;o>y;y++)n[g][y]=L[g][y]+T[g][y]-S[g][y]+W[g][y],n[g][y+o]=C[g][y]+S[g][y],n[g+o][y]=P[g][y]+T[g][y],n[g+o][y+o]=L[g][y]+C[g][y]-P[g][y]-D[g][y]}return n}},{}],21:[function(e,t){"use strict";function r(t,r,s){this.id=s||Date.now();var i=e("./Renderer");n?(this.renderer=null,postMessage({type:"canvas",value:{id:this.id,width:t,height:r,children:[]}})):this.renderer=new i(t,r,document.createElement("div")),this.width=t,this.height=r,Object.seal(this)}var n=e("./isWorker"),s=e("./Img"),i=e("lodash/array/flatten");r.prototype.render=function(e){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);t=i(t),n?postMessage({type:"canvas",value:{id:this.id,width:this.width,height:this.height,children:t}}):this.renderer.render(e)},r.prototype.toImage=function(e){e=e||Date.now();var t;return n?(postMessage({type:"canvas-image",value:{id:this.id,imageID:e}}),t=new s,t.id=e,t):(t=new Image,t.src=this.renderer.canvas.toDataURL("image/png"),void(s.cache[e]=t))},r.prototype.resize=function(e,t){return this.renderer.resize(e,t)},r.cache={},r.create=function(e,t,n){return new r(e,t,n)},Object.seal(r),Object.seal(r.prototype),t.exports=r},{"./Img":22,"./Renderer":24,"./isWorker":42,"lodash/array/flatten":4}],22:[function(e,t){"use strict";function r(e){this._src="",this.isDataUrl=!1,this.id=e||Date.now(),this.buffer=new ArrayBuffer,this.onload=function(){},this.texture=null,this.type="image",this.blobOptions={},Object.seal(this)}var n=e("path"),s=e("./isWorker"),i=e("./isDataUrl");r.cache={},Object.defineProperty(r.prototype,"src",{set:function(e){if("undefined"==typeof window){var t=this;if(this._src=e,this.isDataUrl=i(e),this.isDataUrl)this.id=""+Date.now();else{this.id=e;var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){t.buffer=this.response,t.blobOptions={type:"image/"+n.extname(t._src).slice(1)},t.generateTexture(this.response,t.blobOptions)},r.send()}}},get:function(){return this._src}}),r.prototype.generateTexture=function(e,t){var n,i={type:"image",value:{buffer:e,opts:t,id:this.id}};s?postMessage(i,[e]):(n=new Image,n.src=(window.URL||window.webkitURL).createObjectURL(new Blob([e],t)),r.cache[this.id]=n),this.onload()},t.exports=r},{"./isDataUrl":41,"./isWorker":42,path:1}],23:[function(e,t){"use strict";function r(e,t){this.type=e,this.props=t,Object.seal(this)}t.exports=r},{}],24:[function(e,t){"use strict";function r(e,t,r,n){var s;if(n?(s=this.worker=new Worker(n),s.onmessage=this.workerCommand.bind(this)):this.worker=null,this.tree=null,this.ready=!1,this.frame=null,!o.document)return this.canvas=null,this.ctx=null,this.parent=null,void Object.seal(this);arguments.length<3&&(r=document.createElement("div"),r.style.margin="0 auto",r.style.width=e+"px",r.style.height=t+"px",document.body.appendChild(r)),arguments.length<2&&(e=window.innerWidth,t=window.innerHeight);var i=document.createElement("canvas"),a=i.getContext("2d");i.width=e,i.height=t,r.appendChild(i),this.canvas=i,this.ctx=a,this.parent=r,Object.seal(this)}var n=e("lodash/array/flatten"),s=null,i=e("./isWorker"),o="undefined"!=typeof window?window:this,a=e("./Img"),l=2*Math.PI;r.prototype.render=function(){var t,r,o,c,u,h,f=[],d=[],p=[],g=[],y=[],w=this.ctx,v=[];for(s||(s=e("./Canvas")),t=0,r=arguments.length;r>t;t++)v.push(arguments[t]);if(v=n(v,!0),i)return this.sendBrowser("render",v);for(t=0,r=v.length;r>t;t++)if(o=v[t],c=o.props,u=o.type,"transform"!==u)if("scale"!==u)if("translate"!==u)if("rotate"!==u)if("restore"!==u)if("fillRect"!==o.type)if("strokeRect"!==o.type)if("clearRect"!==u)if("fillStyle"!==u)if("endFillStyle"!==u)if("lineStyle"!==u)if("endLineStyle"!==u)if("textStyle"!==u)if("endTextStyle"!==u)if("shadowStyle"!==u)if("endShadowStyle"!==u)if("text"!==u)if("drawImage"!==u)if("drawImageSize"!==u)if("drawImageSource"!==u)if("drawCanvas"!==u)if("drawCanvasSize"!==u)if("drawCanvasSource"!==u)"strokeArc"!==u?"strokeArc-counterclockwise"!==u?"fillArc"!==u&&"fillArc-counterclockwise"!==u?"moveTo"!==u?"lineTo"!==u?"bezierCurveTo"!==u?"quadraticCurveTo"!==u?"anticlockwise-arc"!==u?"arc"!==u?"full-arc"!==u?"quick-arc"!==u?"arcTo"!==u?"anticlockwise-ellipse"!==u?"ellipse"!==u?"full-ellipse"!==u?"quick-ellipse"!==u?"globalCompositeOperation"!==u?"endGlobalCompositeOperation"!==u?"fill"!==u?"stroke"!==u?"beginPath"!==u?"closePath"!==u||w.closePath():w.beginPath():w.stroke():w.fill():w.globalCompositeOperation=y.pop():(y.push(w.globalCompositeOperation),w.globalCompositeOperation=c.value):(this.save(),this.translate(c.x,c.y),this.scale(c.radiusX,c.radiusY),this.arc(0,0,1,0,l),this.restore()):(this.save(),this.translate(c.x,c.y),this.rotate(c.rotation),this.scale(c.radiusX,c.radiusY),this.arc(0,0,1,0,l),this.restore()):(this.save(),this.translate(c.x,c.y),this.rotate(c.rotation),this.scale(c.radiusX,c.radiusY),this.arc(0,0,1,c.startAngle,c.endAngle),this.restore()):(this.save(),this.translate(c.x,c.y),this.rotate(c.rotation),this.scale(c.radiusX,c.radiusY),this.arc(0,0,1,c.startAngle,c.endAngle,!0),this.restore()):w.arcTo(c.x1,c.y1,c.x2,c.y2,c.r):w.arc(0,0,c.r,0,l):w.arc(c.x,c.y,c.r,0,l):w.arc(c.x,c.y,c.r,c.startAngle,c.endAngle):w.arc(c.x,c.y,c.r,c.startAngle,c.endAngle,!0):w.quadraticCurveTo(c.cpx,c.cpy,c.x,c.y):w.bezierCurveTo(c.cp1x,c.cp1y,c.cp2x,c.cp2y,c.x,c.y):w.lineTo(c.x,c.y):w.moveTo(c.x,c.y):(w.beginPath(),w.arc(c.x,c.y,c.r,c.startAngle,c.endAngle),w.closePath(),w.fill()):(w.beginPath(),w.arc(c.x,c.y,c.r,c.startAngle,c.endAngle,!0),w.closePath(),w.stroke()):(w.beginPath(),w.arc(c.x,c.y,c.r,c.startAngle,c.endAngle),w.closePath(),w.stroke());else{if(!s.cache.hasOwnProperty(c.img))continue;w.drawImage(s.cache[c.img].renderer.canvas,c.sx,c.sy,c.sWidth,c.sHeight,c.dx,c.dy,c.dWidth,c.dHeight)}else{if(!s.cache.hasOwnProperty(c.img))continue;w.drawImage(s.cache[c.img].renderer.canvas,c.dx,c.dy,c.dWidth,c.dHeight)}else{if(!s.cache.hasOwnProperty(c.img))continue;w.drawImage(s.cache[c.img].renderer.canvas,c.dx,c.dy)}else{if(!a.cache.hasOwnProperty(c.img))continue;w.drawImage(a.cache[c.img],c.sx,c.sy,c.sWidth,c.sHeight,c.dx,c.dy,c.dWidth,c.dHeight)}else{if(!a.cache.hasOwnProperty(c.img))continue;w.drawImage(a.cache[c.img],c.dx,c.dy,c.dWidth,c.dHeight)}else{if(!a.cache.hasOwnProperty(c.img))continue;w.drawImage(a.cache[c.img],c.dx,c.dy)}else{if(0!==c.maxWidth){c.fill&&w.fillText(c.text,c.x,c.y,c.maxWidth),c.stroke&&w.strokeText(c.text,c.x,c.y,c.maxWidth);continue}c.fill&&w.fillText(c.text,c.x,c.y),c.stroke&&w.strokeText(c.text,c.x,c.y)}else h=g.pop(),w.shadowBlur=h.shadowBlur,w.shadowColor=h.shadowColor,w.shadowOffsetX=h.shadowOffsetX,w.shadowOffsetY=h.shadowOffsetY;else g.push({shadowBlur:w.shadowBlur,shadowColor:w.shadowColor,shadowOffsetX:w.shadowOffsetX,shadowOffsetY:w.shadowOffsetY}),null!==c.shadowBlur&&(w.shadowBlur=c.shadowBlur),null!==c.shadowColor&&(w.shadowColor=c.shadowColor),null!==c.shadowOffsetX&&(w.shadowOffsetX=c.shadowOffsetX),null!==c.shadowOffsetY&&(w.shadowOffsetY=c.shadowOffsetY);else h=p.pop(),w.font=h.font,w.textAlign=h.textAlign,w.textBaseline=h.textBaseline,w.direction=h.direction;else p.push({font:w.font,textAlign:w.textAlign,textBaseline:w.textBaseline,direction:w.direction}),null!==c.font&&(w.font=c.font),null!==c.textAlign&&(w.textAlign=c.textAlign),null!==c.textBaseline&&(w.textBaseline=c.textBaseline),null!==c.lineJoin&&(w.direction=c.direction);else h=d.pop(),w.strokeStyle=h.strokeStyle,w.lineWidth=h.lineWidth,w.lineCap=h.lineCap,w.lineJoin=h.lineJoin,w.miterLimit=h.miterLimit,w.setLineDash(h.lineDash),w.lineDashOffset=h.lineDashOffset;else d.push({strokeStyle:w.strokeStyle,lineWidth:w.lineWidth,lineCap:w.lineCap,lineJoin:w.lineJoin,miterLimit:w.miterLimit,lineDash:w.getLineDash(),lineDashOffset:w.lineDashOffset}),null!==c.strokeStyle&&(w.strokeStyle=c.strokeStyle),null!==c.lineWidth&&(w.lineWidth=c.lineWidth),null!==c.lineCap&&(w.lineCap=c.lineCap),null!==c.lineJoin&&(w.lineJoin=c.lineJoin),null!==c.miterLimit&&(w.miterLimit=c.miterLimit),c.lineDash.length>0&&w.setLineDash(c.lineDash),null!==c.lineDashOffset&&(w.lineDashOffset=c.lineDashOffset);else w.fillStyle=f.pop();else f.push(w.fillStyle),w.fillStyle=c.value;else w.clearRect(c.x,c.y,c.width,c.height);else w.strokeRect(c.x,c.y,c.width,c.height);else w.fillRect(c.x,c.y,c.width,c.height);else w.restore();else w.save(),w.rotate(o.props.r);else w.save(),w.translate(o.props.x,o.props.y);else w.save(),w.scale(c.x,c.y);else w.save(),w.transform(c.a,c.b,c.c,c.d,c.e,c.f)},r.create=function(e,t,n,s){return arguments.length>2?new r(e,t,n,s):2===arguments.length?new r(e,t):new r},r.prototype.workerCommand=function(t){var r,n=t.data;return s||(s=e("./Canvas")),"ready"===n.type?(this.ready=!0,this.sendWorker("frame",{}),this.hookRender()):"image"===n.type?(r=new a(n.value.id),r.generateTexture(n.value.buffer,n.value.opts)):("render"===n.type&&(this.tree=this.tree?this.tree.concat(n.value):n.value,this.frame||(this.frame=requestAnimationFrame(this.hookRender.bind(this)))),"renderer-resize"===n.type?this.resize(n.value.width,n.value.height):"canvas"===n.type?(s.cache.hasOwnProperty(n.value.id)||(s.cache[n.value.id]=new s(n.value.width,n.value.height,n.value.id)),r=s.cache[n.value.id],r.resize(n.value.width,n.value.height),s.cache[n.value.id].render(n.value.children)):"canvas-image"===n.type&&s.cache.hasOwnProperty(n.value.id)?void s.cache[n.value.id].toImage(n.value.imageID):void 0)},r.prototype.resize=function(e,t){return i?this.sendBrowser("renderer-resize",{width:e,height:t}):(""+this.canvas.width!=""+e&&(this.canvas.width=e),void(""+this.canvas.height!=""+t&&(this.canvas.height=t)))},r.prototype.hookRender=function(){if(this.ready){if(null===this.tree)return requestAnimationFrame(this.hookRender.bind(this));this.sendWorker("frame",{}),this.render(this.tree),this.tree=null,this.frame=null}},r.prototype.sendWorker=function(e,t){return this.worker.postMessage({type:e,value:t})},r.prototype.sendBrowser=function(e,t){return postMessage({type:e,value:t})},Object.seal(r),Object.seal(r.prototype),t.exports=r},{"./Canvas":21,"./Img":22,"./isWorker":42,"lodash/array/flatten":4}],25:[function(e,t){"use strict";function r(e,t,r,s,i,o){return arguments.length>5?new n(o?"anticlockwise-arc":"arc",{x:e,y:t,r:r,startAngle:s,endAngle:i}):5===arguments.length?new n("arc",{x:e,y:t,r:r,startAngle:s,endAngle:i}):arguments.length<3?arguments.length<1?new n("quick-arc",{r:1}):new n("quick-arc",{r:e}):new n("full-arc",{x:e,y:t,r:r})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],26:[function(e,t){"use strict";function r(e,t,r,s,i){return new n("arcTo",{x1:e,y1:t,x2:r,y2:s,r:i})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],27:[function(e,t){"use strict";function r(){return new n("beginPath")}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],28:[function(e,t){"use strict";function r(e,t,r,s,i,o){return new n("bezierCurveTo",{cp1x:e,cp1y:t,cp2x:r,cp2y:s,x:i,y:o})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],29:[function(e,t){"use strict";function r(e,t,r,s){return arguments.length>2?new n("clearRect",{x:e,y:t,width:r,height:s}):new n("clearRect",{x:0,y:0,width:e,height:t})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],30:[function(e,t){"use strict";function r(e){return[n()].concat(e).concat([s()])}var n=e("./beginPath"),s=e("./clipPath");t.exports=r},{"./beginPath":27,"./clipPath":31}],31:[function(e,t){"use strict";function r(){return new n("clipPath")}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],32:[function(e,t){"use strict";function r(){return new n("closePath")}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],33:[function(e,t){"use strict";function r(e,t,r,s,i,o,a,l,c){return 9===arguments.length?new n("drawCanvasSource",{img:e.id,sx:t,sy:r,sWidth:s,sHeight:i,dx:o,dy:a,dWidth:l,dHeight:c}):arguments.length<5?arguments.length<3?new n("drawCanvas",{img:e.id,dx:0,dy:0}):new n("drawCanvas",{img:e.id,dx:t,dy:r}):new n("drawCanvasSize",{img:e.id,dx:t,dy:r,dWidth:s,dHeight:i})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],34:[function(e,t){"use strict";function r(e,t,r,s,i,o,a,l,c){return 9===arguments.length?new n("drawImageSource",{img:e.id,sx:t,sy:r,sWidth:s,sHeight:i,dx:o,dy:a,dWidth:l,dHeight:c}):arguments.length<5?arguments.length<3?new n("drawImage",{img:e.id,dx:0,dy:0}):new n("drawImage",{img:e.id,dx:t,dy:r}):new n("drawImageSize",{img:e.id,dx:t,dy:r,dWidth:s,dHeight:i})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],35:[function(e,t){"use strict";function r(e,t,r,s,i,o,a,l){return arguments.length>7?new n(l?"anticlockwise-ellipse":"ellipse",{x:e,y:t,radiusX:r,radiusY:s,startAngle:o,endAngle:a}):7===arguments.length?new n("ellipse",{x:e,y:t,radiusX:r,radiusY:s,rotation:i,startAngle:o,endAngle:a}):arguments.length<5?4===arguments.length?new n("quick-ellipse",{x:e,y:t,radiusX:r,radiusY:s}):new n("quick-ellipse",{x:0,y:0,radiusX:e,radiusY:t}):new n("full-ellipse",{x:e,y:t,radiusX:r,radiusY:s,rotation:i})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],36:[function(e,t){"use strict";function r(){return new n("fill")}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],37:[function(e,t){"use strict";function r(e,t,r,i,o,a){return arguments.length>=6&&a?new n("fillArc-counterclockwise",{x:e,y:t,r:r,startAngle:i,endAngle:o}):arguments.length>3?new n("fillArc",{x:e,y:t,r:r,startAngle:i,endAngle:o}):arguments.length>1?new n("fillArc",{x:e,y:t,r:r,startAngle:0,endAngle:s}):new n("fillArc",{x:0,y:0,r:e,startAngle:0,endAngle:s})}var n=e("./Instruction"),s=2*Math.PI;t.exports=r},{"./Instruction":23}],38:[function(e,t){"use strict";function r(e,t,r,s){return arguments.length<4?new n("fillRect",{x:0,y:0,width:e,height:t}):new n("fillRect",{x:e,y:t,width:r,height:s})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],39:[function(e,t){"use strict";function r(e,t){return[new n("fillStyle",{value:e})].concat(t).concat([new n("endFillStyle")])}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],40:[function(e){"use strict";e("./Instruction")},{"./Instruction":23}],41:[function(e,t){function r(e){return!!e.match(r.regex)}r.regex=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i,Object.seal(r),t.exports=r},{}],42:[function(e,t){"use strict";t.exports="undefined"==typeof document},{}],43:[function(e,t){"use strict";function r(e,t){e=e||{};var r={strokeStyle:null,lineWidth:null,lineCap:null,lineJoin:null,miterLimit:null,lineDash:[],lineDashOffset:null};return void 0!==e.strokeStyle&&(r.strokeStyle=e.strokeStyle),void 0!==e.lineWidth&&(r.lineWidth=e.lineWidth),void 0!==e.lineCap&&(r.lineCap=e.lineCap),void 0!==e.lineJoin&&(r.lineJoin=e.lineJoin),void 0!==e.miterLimit&&(r.miterLimit=e.miterLimit),void 0!==e.lineDash&&(r.lineDash=e.lineDash),void 0!==e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset),[new n("lineStyle",r)].concat(t).concat([new n("endLineStyle")])}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],44:[function(e,t){"use strict";function r(e,t){return 0===arguments.length?new n("lineTo",{x:0,y:0}):new n("lineTo",{x:e,y:t})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],45:[function(e,t){"use strict";function r(e,t){return 0===arguments.length?new n("moveTo",{x:0,y:0}):new n("moveTo",{x:e,y:t})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],46:[function(e,t){"use strict";function r(e){return[n()].concat(e).concat([s()])}var n=e("./beginPath"),s=e("./closePath");t.exports=r},{"./beginPath":27,"./closePath":32}],47:[function(e,t){"use strict";function r(e,t,r,s){return new n("quadraticCurveTo",{cpx:e,cpy:t,x:r,y:s})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],48:[function(e,t){"use strict";function r(e,t){e=+e,t=t||[];var r=[new n("rotate",{r:e})];return r=r.concat(s(t)),r.push(new n("restore")),r}var n=e("./Instruction"),s=e("lodash/array/flatten");t.exports=r},{"./Instruction":23,"lodash/array/flatten":4}],49:[function(e,t){"use strict";function r(e,t,r){e=+e,t=+t,r=r||[];var i=[new n("scale",{x:e,y:t})];return i=i.concat(s(r)),i.push(new n("restore")),i}var n=e("./Instruction"),s=e("lodash/array/flatten");t.exports=r},{"./Instruction":23,"lodash/array/flatten":4}],50:[function(e,t){"use strict";function r(e,t){e=e||{};var r={shadowBlur:null,shadowColor:null,shadowOffsetX:null,shadowOffsetY:null};return void 0!==e.shadowBlur&&(r.shadowBlur=e.shadowBlur),void 0!==e.shadowColor&&(r.shadowColor=e.shadowColor),void 0!==e.shadowOffsetX&&(r.shadowOffsetX=e.shadowOffsetX),void 0!==e.direction&&(r.shadowOffsetY=e.shadowOffsetY),[new n("shadowStyle",e)].concat(t).concat([new n("endShadowStyle")])}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],51:[function(e,t){"use strict";function r(){return new n("stroke")}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],52:[function(e,t){"use strict";function r(e,t,r,i,o,a){return arguments.length>=6&&a?new n("strokeArc-counterclockwise",{x:e,y:t,r:r,startAngle:i,endAngle:o}):arguments.length>3?new n("strokeArc",{x:e,y:t,r:r,startAngle:i,endAngle:o}):arguments.length>1?new n("strokeArc",{x:e,y:t,r:r,startAngle:0,endAngle:s}):new n("strokeArc",{x:0,y:0,r:e,startAngle:0,endAngle:s})}var n=e("./Instruction"),s=2*Math.PI;t.exports=r},{"./Instruction":23}],53:[function(e,t){"use strict";function r(e,t,r,s){return arguments.length>2?new n("strokeRect",{x:e,y:t,width:r,height:s}):new n("strokeRect",{x:0,y:0,width:e,height:t})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],54:[function(e,t){"use strict";function r(e,t,r,s,i,o){return 6===arguments.length?new n("text",{x:t,y:r,fill:s,stroke:i,text:e,maxWidth:o}):5===arguments.length?new n("text",{x:t,y:r,fill:s,stroke:i,text:e,maxWidth:0}):4===arguments.length?new n("text",{x:t,y:r,fill:s,stroke:!1,text:e,maxWidth:0}):3===arguments.length?new n("text",{x:t,y:r,fill:!0,stroke:!1,text:e,maxWidth:0}):new n("text",{x:0,y:0,fill:!0,stroke:!1,text:e,maxWidth:0})}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],55:[function(e,t){"use strict";function r(e,t){e=e||{};var r={font:null,textAlign:null,textBaseline:null,direction:null};return void 0!==e.font&&(r.font=e.font),void 0!==e.textAlign&&(r.textAlign=e.textAlign),void 0!==e.textBaseline&&(r.textBaseline=e.textBaseline),void 0!==e.direction&&(r.direction=e.direction),[new n("textStyle",e)].concat(t).concat([new n("endTextStyle")])}var n=e("./Instruction");t.exports=r},{"./Instruction":23}],56:[function(e,t){"use strict";function r(e,t){var r,n,o,a,l,c,u,h=[[1,0,0],[0,1,0],[0,0,1]],f=[],d=e.length;for(n=0;d>n;n++)r=e[n],r.hasOwnProperty("transform")?h=s(h,[[r.transform.a,r.transform.c,r.transform.e],[r.transform.b,r.transform.d,r.transform.f],[0,0,1]]):(r.hasOwnProperty("translate")&&(l=r.translate.x,c=r.translate.y,h=s(h,[[1,0,l],[0,1,c],[0,0,1]])),r.hasOwnProperty("scale")&&(l=r.scale.x,c=r.scale.y,h=s(h,[[l,0,0],[0,c,0],[0,0,1]])),r.hasOwnProperty("rotate")&&(a=Math.sin(r.rotate),o=Math.cos(r.rotate),h=s(h,[[o,-a,0],[a,o,0],[0,0,1]])));return u={a:h[0][0],b:h[1][0],c:h[0][1],d:h[1][1],e:h[0][2],f:h[1][2]},f.concat(new i("transform",u)).concat(t).concat([new i("restore")])}function n(e,t){var r=e[0];return[new i("transform",{a:r.props.a,b:r.props.b,c:r.props.c,d:r.props.d,e:r.props.e,f:r.props.f})].concat(t).concat([new i("restore")])}var s=e("square-matrix-multiply"),i=e("./Instruction");r.copy=n,t.exports=r},{"./Instruction":23,"square-matrix-multiply":20}],57:[function(e,t){"use strict";function r(e,t,r){e=+e,t=+t,r=r||[];var i=[new n("translate",{x:e,y:t})];return i=i.concat(s(r)),i.push(new n("restore")),i}var n=e("./Instruction"),s=e("lodash/array/flatten");t.exports=r},{"./Instruction":23,"lodash/array/flatten":4}]},{},[3])(3)});